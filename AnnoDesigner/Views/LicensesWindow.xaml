<Window
    x:Class="AnnoDesigner.LicensesWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:coreConverters="clr-namespace:AnnoDesigner.Core.Converters;assembly=AnnoDesigner.Core"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ext="clr-namespace:AnnoDesigner.Core.Extensions.XamlExtensions;assembly=AnnoDesigner.Core"
    xmlns:l="clr-namespace:AnnoDesigner.Localization"
    xmlns:local="clr-namespace:AnnoDesigner"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="clr-namespace:AnnoDesigner.ViewModels"
    Title="{l:Localize Licenses}"
    FontFamily="Segoe UI"
    Width="600"
    Height="450"
    d:DataContext="{d:DesignInstance IsDesignTimeCreatable=True,
                                     Type={x:Type viewModels:LicensesViewModel}}"
    IsTabStop="False"
    mc:Ignorable="d">
    <Window.Resources>
        <coreConverters:BoolToVisibilityConverter
            x:Key="BoolToVisibilityConverter"
            FalseValue="Collapsed"
            TrueValue="Visible" />
    </Window.Resources>
    <ScrollViewer
        Focusable="False"
        HorizontalScrollBarVisibility="Auto"
        IsTabStop="False"
        VerticalScrollBarVisibility="Auto">
        <Grid Grid.IsSharedSizeScope="True">
            <ItemsControl Background="{x:Null}" ItemsSource="{Binding Licenses}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="10,5,10,5">
                            <Grid VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="License" />
                                        <ColumnDefinition Width="*" SharedSizeGroup="ProjectURL" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.ColumnSpan="2"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Text="{Binding ProjectName}" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Margin="0,0,10,0"
                                        FontWeight="Heavy"
                                        Foreground="#888"
                                        Text="{Binding License}" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Margin="0,0,10,0">
                                        <Hyperlink
                                            ext:HyperlinkExtensions.IsExternal="True"
                                            ext:HyperlinkExtensions.NavigationMessage="{l:Localize ExternalLinkConfirmationMessage}"
                                            ext:HyperlinkExtensions.NavigationTitle="{l:Localize ExternalLinkMessageTitle}"
                                            NavigateUri="{Binding ProjectWebsite}">
                                            <Run Text="{Binding ProjectWebsite}" />
                                        </Hyperlink>
                                    </TextBlock>
                                </Grid>
                                <ToggleButton
                                    x:Name="ShowAssets"
                                    Grid.Row="1"
                                    Grid.RowSpan="2"
                                    Grid.Column="1"
                                    Template="{DynamicResource ToggleButtonTemplate}"
                                    Visibility="{Binding HasAssets, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <ToggleButton.Resources>
                                        <ControlTemplate x:Key="ToggleButtonTemplate" TargetType="{x:Type ToggleButton}">
                                            <Grid>
                                                <Image
                                                    x:Name="image"
                                                    Width="48"
                                                    RenderTransformOrigin="0.5,0.5"
                                                    Source="pack://application:,,,/Images/Icons/chevron-down.png">
                                                    <Image.RenderTransform>
                                                        <!--  This empty child element is required for the transition state  -->
                                                        <TransformGroup>
                                                            <RotateTransform />
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CheckStates">
                                                        <VisualStateGroup.Transitions>
                                                            <VisualTransition
                                                                GeneratedDuration="0"
                                                                From="Checked"
                                                                To="Unchecked" />
                                                        </VisualStateGroup.Transitions>
                                                        <VisualState x:Name="Checked">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="image" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(RotateTransform.Angle)">
                                                                    <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="180" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Unchecked">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="image" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(RotateTransform.Angle)">
                                                                    <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="0" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>
                                            </Grid>
                                        </ControlTemplate>
                                    </ToggleButton.Resources>
                                </ToggleButton>
                            </Grid>
                            <ItemsControl
                                x:Name="itemsControl"
                                ItemsSource="{Binding Assets}"
                                Visibility="{Binding IsChecked, Converter={StaticResource BoolToVisibilityConverter}, ElementName=ShowAssets}">
                                <!--  Maybe add multiple columns of assets here in future, or remove this entirely if it becomes impractical or unecessary  -->
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Grid>
    </ScrollViewer>
</Window>
