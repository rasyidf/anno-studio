<Page
    x:Class="AnnoDesigner.PreferencesPages.GeneralSettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:annoDesigner="clr-namespace:AnnoDesigner"
    xmlns:converters="clr-namespace:AnnoDesigner.Converters"
    xmlns:coreConverters="clr-namespace:AnnoDesigner.Core.Converters;assembly=AnnoDesigner.Core"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:l="clr-namespace:AnnoDesigner.Localization"
    xmlns:local="clr-namespace:AnnoDesigner.PreferencesPages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:viewModels="clr-namespace:AnnoDesigner.ViewModels"
    xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
    d:Background="White"
    d:DataContext="{d:DesignInstance Type=viewModels:GeneralSettingsViewModel,
                                     IsDesignTimeCreatable=False}"
    d:DesignHeight="1050"
    d:DesignWidth="800"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    mc:Ignorable="d">
    <Page.Resources>
        <coreConverters:BoolToVisibilityConverter
            x:Key="converterBoolToVisibilityCollapsed"
            FalseValue="Collapsed"
            TrueValue="Visible" />
        <converters:UserDefinedColorToDisplayNameConverter x:Key="converterUserDefinedColorToDisplayName" />
    </Page.Resources>

    <StackPanel Margin="0" Orientation="Vertical">

        <!--  Appearance: theme + colors  -->
        <ui:CardExpander
            ContentPadding="0"
            Icon="{ui:SymbolIcon PlaySettings20}"
            IsExpanded="True">
            <ui:CardExpander.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <ui:TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        FontSize="16"
                        FontTypography="Body"
                        Text="{l:Localize GeneralPreferencesUISettings}" />
                    <ui:TextBlock
                        Grid.Row="1"
                        Grid.Column="0"
                        FontSize="12"
                        Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}"
                        Text="{l:Localize GeneralPreferencesUISettingsDescription}" />
                </Grid>
            </ui:CardExpander.Header>

            <StackPanel Margin="0">
                <ui:CardControl Padding="12" Header="{l:Localize Theme}">
                    <ComboBox
                        Width="220"
                        ItemsSource="{Binding ThemeOptions}"
                        SelectedItem="{Binding SelectedTheme}" />
                </ui:CardControl>

                <ui:CardControl Padding="12" Header="{l:Localize GeneralPreferencesGridLinesColor}">
                    <StackPanel Orientation="Horizontal">
                        <ComboBox
                            Width="160"
                            IsEnabled="True"
                            ItemsSource="{Binding GridLineColors}"
                            SelectedItem="{Binding SelectedGridLineColor}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Converter={StaticResource converterUserDefinedColorToDisplayName}}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        <xctk:ColorPicker
                            Width="160"
                            Margin="8,0,0,0"
                            AdvancedTabHeader="{l:Localize Advanced}"
                            AvailableColorsHeader="{l:Localize AvailableColors}"
                            AvailableColorsSortingMode="HueSaturationBrightness"
                            DisplayColorAndName="True"
                            DisplayColorTooltip="True"
                            RecentColorsHeader="{l:Localize RecentColors}"
                            SelectedColor="{Binding SelectedCustomGridLineColor}"
                            ShowAvailableColors="True"
                            ShowDropDownButton="True"
                            ShowRecentColors="True"
                            ShowStandardColors="False"
                            StandardColorsHeader="{l:Localize StandardColors}"
                            StandardTabHeader="{l:Localize Standard}"
                            Visibility="{Binding IsGridLineColorPickerVisible, Converter={StaticResource converterBoolToVisibilityCollapsed}}" />
                    </StackPanel>
                </ui:CardControl>

                <ui:CardControl Padding="12" Header="{l:Localize GeneralPreferencesObjectBorderLinesColor}">
                    <StackPanel Orientation="Horizontal">
                        <ComboBox
                            Width="160"
                            IsEnabled="True"
                            ItemsSource="{Binding ObjectBorderLineColors}"
                            SelectedItem="{Binding SelectedObjectBorderLineColor}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Converter={StaticResource converterUserDefinedColorToDisplayName}}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        <xctk:ColorPicker
                            Width="160"
                            Margin="8,0,0,0"
                            AdvancedTabHeader="{l:Localize Advanced}"
                            AvailableColorsHeader="{l:Localize AvailableColors}"
                            AvailableColorsSortingMode="HueSaturationBrightness"
                            DisplayColorAndName="True"
                            DisplayColorTooltip="True"
                            RecentColorsHeader="{l:Localize RecentColors}"
                            SelectedColor="{Binding SelectedCustomObjectBorderLineColor}"
                            ShowAvailableColors="True"
                            ShowDropDownButton="True"
                            ShowRecentColors="True"
                            ShowStandardColors="False"
                            StandardColorsHeader="{l:Localize StandardColors}"
                            StandardTabHeader="{l:Localize Standard}"
                            Visibility="{Binding IsObjectBorderLineColorPickerVisible, Converter={StaticResource converterBoolToVisibilityCollapsed}}" />
                    </StackPanel>
                </ui:CardControl>
            </StackPanel>
        </ui:CardExpander>

        <!--  Navigation: zoom settings  -->
        <ui:CardExpander
            Margin="0,8,0,0"
            ContentPadding="0"
            Icon="{ui:SymbolIcon Symbol=ZoomFit20}"
            IsExpanded="True">
            <ui:CardExpander.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <ui:TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        FontSize="16"
                        FontTypography="Body"
                        Text="{l:Localize GeneralPreferencesNavigation}" />
                    <ui:TextBlock
                        Grid.Row="1"
                        Grid.Column="0"
                        FontSize="12"
                        Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}"
                        Text="{l:Localize GeneralPreferencesNavigationDescription}" />
                </Grid>
            </ui:CardExpander.Header>

            <StackPanel Margin="0,0,10,0">
                <ui:CardControl Padding="12" Header="{l:Localize GeneralPreferencesZoomSensitivity}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Slider
                            Name="ZoomSlider"
                            Grid.Column="0"
                            Width="220"
                            IsSnapToTickEnabled="True"
                            Maximum="{x:Static annoDesigner:Constants.ZoomSensitivitySliderMaximum}"
                            Minimum="1"
                            TickFrequency="1"
                            TickPlacement="None"
                            Value="{Binding ZoomSensitivityPercentage}" />
                        <TextBlock
                            Grid.Column="1"
                            Margin="6,0,0,0"
                            VerticalAlignment="Center"
                            Text="{Binding ElementName=ZoomSlider, Path=Value, StringFormat='{}{0}%'}" />
                        <Button
                            Grid.Column="2"
                            Margin="16,0,0,0"
                            Padding="5,2"
                            Command="{Binding ResetZoomSensitivityCommand}"
                            Content="{l:Localize Default}" />
                    </Grid>
                </ui:CardControl>
            </StackPanel>
        </ui:CardExpander>

        <!--  Interaction: behavior toggles  -->
        <ui:CardExpander
            Margin="0,10,0,0"
            ContentPadding="0"
            Icon="{ui:SymbolIcon Symbol=Cursor20}"
            IsExpanded="True">
            <ui:CardExpander.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <ui:TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        FontSize="16"
                        FontTypography="Body"
                        Text="{l:Localize GeneralPreferencesInteraction}" />
                    <ui:TextBlock
                        Grid.Row="1"
                        Grid.Column="0"
                        FontSize="12"
                        Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}"
                        Text="{l:Localize GeneralPreferencesInteractionDescription}" />
                </Grid>
            </ui:CardExpander.Header>

            <StackPanel>
                <ui:CardControl Padding="12">
                    <ui:CardControl.Header>
                        <CheckBox Content="{l:Localize GeneralPreferencesUseZoomToPoint}" IsChecked="{Binding UseZoomToPoint}" />
                    </ui:CardControl.Header>
                </ui:CardControl>
                <ui:CardControl Padding="12">
                    <ui:CardControl.Header>
                        <CheckBox Content="{l:Localize GeneralPreferencesInvertPanningDirection}" IsChecked="{Binding InvertPanningDirection}" />
                    </ui:CardControl.Header>
                </ui:CardControl>
                <ui:CardControl Padding="12">
                    <ui:CardControl.Header>
                        <CheckBox Content="{l:Localize GeneralPreferencesShowScrollbars}" IsChecked="{Binding ShowScrollbars}" />
                    </ui:CardControl.Header>
                </ui:CardControl>
                <ui:CardControl Padding="12">
                    <ui:CardControl.Header>
                        <CheckBox Content="{l:Localize GeneralPreferencesInvertScrollingDirection}" IsChecked="{Binding InvertScrollingDirection}" />
                    </ui:CardControl.Header>
                </ui:CardControl>
                <ui:CardControl Padding="12">
                    <ui:CardControl.Header>
                        <CheckBox Content="{l:Localize GeneralPreferencesHideInfluenceOnSelection}" IsChecked="{Binding HideInfluenceOnSelection}" />
                    </ui:CardControl.Header>
                </ui:CardControl>
                <ui:CardControl Padding="12">
                    <ui:CardControl.Header>
                        <CheckBox Content="{l:Localize GeneralPreferencesIncludeRoadsInStatisticCalculation}" IsChecked="{Binding IncludeRoadsInStatisticCalculation}" />
                    </ui:CardControl.Header>
                </ui:CardControl>
            </StackPanel>
        </ui:CardExpander>

        <ui:CardExpander
            Margin="0,10,0,10"
            ContentPadding="0"
            Header="{l:Localize GeneralPreferencesRecentFilesSettings}"
            IsExpanded="True">
            <ui:CardControl Header="{l:Localize GeneralPreferencesMaxRecentFiles, StringFormat='\{0\}:', Mode=OneWay}">
                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" MinWidth="154" />
                    </Grid.ColumnDefinitions>

                    <ui:NumberBox
                        Margin="20,0,20,0"
                        VerticalAlignment="Stretch"
                        IsEnabled="True"
                        LargeChange="1"
                        MaxDecimalPlaces="0"
                        Maximum="100"
                        Minimum="1"
                        SpinButtonPlacementMode="Compact"
                        TabIndex="0"
                        Value="{Binding MaxRecentFiles, FallbackValue=0, TargetNullValue=0}" />
                    <StackPanel
                        Grid.Column="1"
                        Margin="0,2,0,2"
                        Orientation="Horizontal"
                        d:LayoutOverrides="Height">

                        <Button
                            Height="32"
                            Command="{Binding ResetMaxRecentFilesCommand}"
                            Content="{l:Localize Default}"
                            d:LayoutOverrides="LeftPosition, RightPosition" />
                        <Button
                            Height="32"
                            Command="{Binding ClearRecentFilesCommand}"
                            Content="{l:Localize Clear}" />
                    </StackPanel>
                </Grid>
            </ui:CardControl>

        </ui:CardExpander>

    </StackPanel>

</Page>
